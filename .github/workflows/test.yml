name: testyml
on:
  schedule:
    - cron:  '30 17 * * *'
jobs:
  build:
    runs-on: macOS-latest
    env:
      GITHUB_PAT: ${{ secrets.GITHUB_TOKEN }}
    steps:
    - uses: actions/checkout@v2
    - uses: r-lib/actions/setup-pandoc@v1
    - name: Setup R
      uses: r-lib/actions/setup-r@master
     
      
    - name: Setup dependencies
      run: |
        R -e 'install.packages("tidyverse")'
        R -e 'install.packages("rvest")'
        R -e 'install.packages("utilities")'
        R -e 'install.packages("pdftools")'
        R -e 'install.packages("tidytext")'
        R -e 'install.packages("unpivotr")'
        R -e 'install.packages("foreach")'
        R -e 'install.packages("renv")'
        R -e 'install.packages("rmarkdown")'
     
     
    - name: run the script
      env: 
        repo_token: ${{secrets.GITHUB_TOKEN }}
      run: |
        Rscript pdfs.R
  
    - name: Commit files # commit the output folder
      run: git status
    - name: fetch
      run: git fetch --all
    - name: stage changed files
      run: git add --a
    - name: commit changed files
      run: git commit -m "Auto updating testmarkdown.Rmd"
    - name: push code 
      run: git push
